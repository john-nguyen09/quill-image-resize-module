!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ImageResize=e():t.ImageResize=e()}(window,(function(){return function(t){var e={};function o(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){"use strict";o.r(e),o.d(e,"default",(function(){return v}));var n={modules:["DisplaySize","Resize"],overlayStyles:{position:"absolute",boxSizing:"border-box",border:"1px dashed #444"},handleStyles:{position:"absolute",height:"12px",width:"12px",backgroundColor:"white",border:"1px solid #777",boxSizing:"border-box",opacity:"0.80"},displayStyles:{position:"absolute",font:"12px/1.0 Arial, Helvetica, sans-serif",padding:"4px 8px",textAlign:"center",backgroundColor:"white",color:"#333",border:"1px solid #777",boxSizing:"border-box",opacity:"0.80",cursor:"default"}};var i=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.onCreate=function(){},this.onDestroy=function(){},this.onUpdate=function(){},this.overlay=e.overlay,this.img=e.img,this.options=e.options,this.requestUpdate=e.onUpdate};function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=a(t);if(e){var i=a(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return u(this,o)}}function u(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=m(t);if(e){var i=m(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return y(this,o)}}function y(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var b={DisplaySize:function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(o,t);var e=c(o);function o(){var t,n;s(this,o);for(var i=arguments.length,r=new Array(i),l=0;l<i;l++)r[l]=arguments[l];return u(n,(t=n=e.call.apply(e,[this].concat(r)),n.onCreate=function(){n.display=document.createElement("div"),Object.assign(n.display.style,n.options.displayStyles),n.overlay.appendChild(n.display)},n.onDestroy=function(){},n.onUpdate=function(){if(n.display&&n.img){var t=n.getCurrentSize();if(n.display.innerHTML=t.join(" &times; "),t[0]>120&&t[1]>30)Object.assign(n.display.style,{right:"4px",bottom:"4px",left:"auto"});else if("right"==n.img.style.float){var e=n.display.getBoundingClientRect();Object.assign(n.display.style,{right:"auto",bottom:"-".concat(e.height+4,"px"),left:"-".concat(e.width+4,"px")})}else{var o=n.display.getBoundingClientRect();Object.assign(n.display.style,{right:"-".concat(o.width+4,"px"),bottom:"-".concat(o.height+4,"px"),left:"auto"})}}},n.getCurrentSize=function(){return[n.img.width,Math.round(n.img.width/n.img.naturalWidth*n.img.naturalHeight)]},t))}return o}(i),Resize:function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(o,t);var e=h(o);function o(){var t,n;d(this,o);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return y(n,(t=n=e.call.apply(e,[this].concat(r)),n.onCreate=function(){n.boxes=[],n.addBox("nwse-resize"),n.addBox("nesw-resize"),n.addBox("nwse-resize"),n.addBox("nesw-resize"),n.positionBoxes()},n.onDestroy=function(){n.setCursor("")},n.positionBoxes=function(){var t="".concat(-parseFloat(n.options.handleStyles.width)/2,"px"),e="".concat(-parseFloat(n.options.handleStyles.height)/2,"px");[{left:t,top:e},{right:t,top:e},{right:t,bottom:e},{left:t,bottom:e}].forEach((function(t,e){Object.assign(n.boxes[e].style,t)}))},n.addBox=function(t){var e=document.createElement("div");Object.assign(e.style,n.options.handleStyles),e.style.cursor=t,e.style.width="".concat(n.options.handleStyles.width,"px"),e.style.height="".concat(n.options.handleStyles.height,"px"),e.addEventListener("mousedown",n.handleMousedown,!1),n.overlay.appendChild(e),n.boxes.push(e)},n.handleMousedown=function(t){n.dragBox=t.target,n.dragStartX=t.clientX,n.preDragWidth=n.img.width||n.img.naturalWidth,n.setCursor(n.dragBox.style.cursor),document.addEventListener("mousemove",n.handleDrag,!1),document.addEventListener("mouseup",n.handleMouseup,!1)},n.handleMouseup=function(){n.setCursor(""),document.removeEventListener("mousemove",n.handleDrag),document.removeEventListener("mouseup",n.handleMouseup)},n.handleDrag=function(t){if(n.img){var e=t.clientX-n.dragStartX;n.dragBox===n.boxes[0]||n.dragBox===n.boxes[3]?n.img.width=Math.round(n.preDragWidth-e):n.img.width=Math.round(n.preDragWidth+e),n.requestUpdate()}},n.setCursor=function(t){[document.body,n.img].forEach((function(e){e.style.cursor=t}))},t))}return o}(i)},v=function t(e){var o=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};g(this,t),this.initializeModules=function(){o.removeModules(),o.modules=o.moduleClasses.map((function(t){return new(b[t]||t)(o)})),o.modules.forEach((function(t){t.onCreate()})),o.onUpdate()},this.onUpdate=function(){o.repositionElements(),o.modules.forEach((function(t){t.onUpdate()}))},this.removeModules=function(){o.modules.forEach((function(t){t.onDestroy()})),o.modules=[]},this.handleClick=function(t){if(t.target&&t.target.tagName&&"IMG"===t.target.tagName.toUpperCase()){if(o.img===t.target)return;o.img&&o.hide(),o.show(t.target),t.preventDefault()}else o.img&&o.hide()},this.handleScroll=function(){o.hide()},this.show=function(t){o.img=t,o.showOverlay(),o.initializeModules()},this.showOverlay=function(){o.overlay&&o.hideOverlay();var t=o.quill.constructor.find(o.img),e=o.quill.getIndex(t);o.quill.setSelection(e,0),document.addEventListener("keyup",o.checkImage,!0),o.quill.root.addEventListener("input",o.checkImage,!0),o.overlay=document.createElement("div"),Object.assign(o.overlay.style,o.options.overlayStyles),o.quill.root.parentNode.appendChild(o.overlay),o.repositionElements()},this.hideOverlay=function(){o.overlay&&(o.quill.root.parentNode.removeChild(o.overlay),o.overlay=void 0,document.removeEventListener("keyup",o.checkImage),o.quill.root.removeEventListener("input",o.checkImage))},this.repositionElements=function(){if(o.overlay&&o.img){var t=o.quill.root.parentNode,e=o.img.getBoundingClientRect(),n=t.getBoundingClientRect();Object.assign(o.overlay.style,{left:"".concat(e.left-n.left-1+t.scrollLeft,"px"),top:"".concat(e.top-n.top+t.scrollTop,"px"),width:"".concat(e.width,"px"),height:"".concat(e.height,"px")})}},this.hide=function(){o.hideOverlay(),o.removeModules(),o.img=void 0},this.setUserSelect=function(t){["userSelect","mozUserSelect","webkitUserSelect","msUserSelect"].forEach((function(e){o.quill.root.style[e]=t,document.documentElement.style[e]=t}))},this.checkImage=function(t){o.img&&(46!=t.keyCode&&8!=t.keyCode||(window.Quill||Quill).find(o.img).deleteAt(0),o.hide())},this.quill=e;var r=!1;i.modules&&(r=i.modules.slice()),this.options=Object.assign({},i,n),!1!==r&&(this.options.modules=r),document.execCommand("enableObjectResizing",!1,"false"),this.quill.root.addEventListener("click",this.handleClick,!1),this.quill.root.addEventListener("mscontrolselect",this.handleClick,!1),this.quill.root.addEventListener("scroll",this.handleScroll,!1),this.quill.root.parentNode.style.position=this.quill.root.parentNode.style.position||"relative",this.quill.on("text-change",(function(){o.repositionElements()})),this.moduleClasses=this.options.modules,this.modules=[]}}])}));